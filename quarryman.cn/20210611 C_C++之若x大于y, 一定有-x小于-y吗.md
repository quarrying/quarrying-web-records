#! https://zhuanlan.zhihu.com/p/379735948
@title C/C++之若x大于y, 一定有-x小于-y吗


在数学中, 若 $x > y$, 则肯定有 $-x < -y$, 但在计算机中这一结论未必成立.
例如下面的代码就输出 1 和 0, 而不是期望的 1 和 1.
```c++
#include <iostream>

int main()
{
    signed int x = 0;
    signed int y = INT_MIN;
    std::cout << (x > y) << std::endl;
    std::cout << (-x < -y) << std::endl;

    std::getchar();
    return 0;
}
```
这一现象与 C/C++ 中符号数的编码方式 (一般为 two's complement 编码) 有关. 分析如下:

设符号数的位数为 $n$, 则其取值范围为 $[-2^{n-1}, 2^{n-1} - 1]$. 当 $x = -2^{n-1}$ 时, $-x = (-x + 2^{n-1}) \mod 2^n - 2^{n-1} = -2^{n-1}$ (注: 第一个 $-x$ 是 C/C++ 上的符号, 第二个 $-x$ 是数学上的符号), 即 $x$ 与 $-x$ 相等. 这就是上面代码中 $x > y$ 时 $-x < -y$ 不成立的原因. 

实际上如果 $x$ 和 $y$ 都不为 $-2^{n-1}$, **"若 $x > y$, 则 $-x < -y$"** 这一结论是没问题的. 但这个前提让这个结论显得不那么优雅, 所以引出下面的结论: 对于符号数 $x$ 和 $y$, 若 $x > y$, 则 $\sim x < \sim y$. 证明如下:

设 $x$ 和 $y$ 是 $n$ 位的符号数, 即 $x, y \in [-2^{n-1}, 2^{n-1} - 1]$, 则 $-1 - x, -1 - y \in [-2^{n-1}, 2^{n-1} - 1]$, 即 $-1 - x$, $-1 - y$ 也在 $n$ 位符号数的取值范围内. 所以当 $x > y$ 时, $-1 - x < -1 - y$, 又因为 $\sim x = -1 - x$ 和 $\sim y = -1 - y$ (证明详见: https://www.zhihu.com/question/408097261/answer/1351647550), 所以 $\sim x < \sim y$ .

对于无符号数也有类似的结论: 对于无符号数 $x$ 和 $y$, 若 $x > y$, 则 $\sim x < \sim y$. 

设 $x$ 和 $y$ 是 $n$ 位的无符号数, 即 $x, y \in [0, 2^n - 1]$, 则 $2^n - 1 - x,  2^n - 1 - y \in [0, 2^n -1]$, 即 $2^n - 1 - x$, $2^n - 1 - y$ 在 $n$ 位无符号数的取值范围内. 所以当 $x > y$ 时, $2^n - 1 - x < 2^n - 1 - y$, 又因为 $\sim x = 2^n - 1 - x$ 和 $\sim y = 2^n - 1 - y$ (证明详见: https://www.zhihu.com/question/408097261/answer/1351647550), 所以 $\sim x < \sim y$ .

综上: 对于整型 $x$ 和 $y$, 若 $x > y$, 则不一定有  $-x < -y$, 但一定有 $\sim x < \sim y$.

## **更新记录**
- 20210611, 发布

## **版权声明**
保持署名-非商业用途-非衍生, 知识共享3.0协议.  
